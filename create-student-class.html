<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Teacher Dashboard â€“ Student Management</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --primary:#2563eb;
  --danger:#dc2626;
  --warning:#f59e0b;
  --bg:#f1f5f9;
  --card:#ffffff;
  --text:#0f172a;
  --muted:#64748b;
}
*{box-sizing:border-box;font-family:Inter,sans-serif}
body{margin:0;background:var(--bg);color:var(--text)}
nav{
  background:#020617;
  color:#fff;
  padding:16px 28px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
nav h1{margin:0;font-size:18px;font-weight:600}
main{
  max-width:1200px;
  margin:32px auto;
  padding:0 20px;
}
.grid{
  display:grid;
  grid-template-columns:360px 1fr;
  gap:24px;
}
.card{
  background:var(--card);
  border-radius:14px;
  padding:20px;
  box-shadow:0 10px 30px rgba(0,0,0,.05);
}
.card h2{
  margin:0 0 16px;
  font-size:16px;
  font-weight:600;
}
label{
  display:block;
  font-size:13px;
  margin-bottom:6px;
  color:var(--muted);
}
input,select{
  width:100%;
  padding:10px 12px;
  border-radius:8px;
  border:1px solid #cbd5f5;
  margin-bottom:14px;
}
button{
  padding:10px 14px;
  border-radius:8px;
  border:none;
  font-size:14px;
  cursor:pointer;
}
.primary{background:var(--primary);color:#fff}
.secondary{background:#e5e7eb}
.warning{background:var(--warning);color:#fff}
.danger{background:var(--danger);color:#fff}
button:disabled{opacity:.6;cursor:not-allowed}
.status{
  margin-top:10px;
  font-size:13px;
}
.success{color:#16a34a}
.error{color:#dc2626}
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  padding:12px;
  border-bottom:1px solid #e5e7eb;
  font-size:14px;
}
th{text-align:left;color:var(--muted);font-weight:500}
.actions button{
  margin-right:6px;
  font-size:12px;
}
footer{
  text-align:center;
  padding:20px;
  color:var(--muted);
  font-size:13px;
}
@media(max-width:900px){
  .grid{grid-template-columns:1fr}
}
</style>
</head>

<body>

<nav>
  <h1>ðŸ“˜ Teacher Dashboard</h1>
  <span>Student Management</span>
</nav>

<main>
<div class="grid">

  <!-- FORM -->
  <div class="card">
    <h2 id="formTitle">Create Student</h2>

    <label>Name</label>
    <input id="nameInput" placeholder="Student full name" />

    <label>Class</label>
    <input id="classInput" placeholder="e.g. Year 5" />

    <label>Email</label>
    <input id="emailInput" type="email" placeholder="student@email.com" />

    <label>Password</label>
    <input id="passwordInput" type="password" placeholder="Enter password" />

    <button id="submitBtn" class="primary">Create Student</button>
    <button id="cancelBtn" class="secondary" style="display:none">Cancel</button>

    <div id="status" class="status"></div>
  </div>

  <!-- LIST -->
  <div class="card">
    <h2>Students</h2>

    <select id="classFilter">
      <option value="">All Classes</option>
    </select>

    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Class</th>
          <th>Email</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="studentsTable"></tbody>
    </table>
  </div>

</div>
</main>

<footer>Â© 2026 Math Quiz Platform</footer>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>

<script>
// Initialize Firebase
const firebaseConfig = {
  apiKey: "AIzaSyB4DMYZJHWgbRUZV-uamOy7TpxLM1sGYPY",
  authDomain: "chats-afcff.firebaseapp.com",
  databaseURL: "https://chats-afcff-default-rtdb.firebaseio.com",
  projectId: "chats-afcff",
  storageBucket: "chats-afcff.firebasestorage.app",
  messagingSenderId: "764250889947",
  appId: "1:764250889947:web:2c843497ce389edf5876fe"
};
firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.database();

// DOM references
const nameEl = document.getElementById("nameInput");
const classEl = document.getElementById("classInput");
const emailEl = document.getElementById("emailInput");
const passwordEl = document.getElementById("passwordInput");
const tableEl = document.getElementById("studentsTable");
const filterEl = document.getElementById("classFilter");
const statusEl = document.getElementById("status");
const submitBtn = document.getElementById("submitBtn");
const cancelBtn = document.getElementById("cancelBtn");
const formTitle = document.getElementById("formTitle");

let editingId = null;

// CREATE / UPDATE
submitBtn.onclick = async () => {
  statusEl.textContent = "";
  statusEl.className = "status";
  const name = nameEl.value.trim();
  const className = classEl.value.trim();
  const email = emailEl.value.trim();
  const password = passwordEl.value.trim();

  if (!name || !className || !email || (!editingId && !password)) {
    statusEl.textContent = "Please fill all fields.";
    statusEl.classList.add("error");
    return;
  }

  try {
    if (editingId) {
      await db.ref("students/" + editingId).update({ name, class: className });
      statusEl.textContent = "Student updated successfully.";
      statusEl.classList.add("success");
      resetForm();
    } else {
      const cred = await auth.createUserWithEmailAndPassword(email, password);
      await db.ref("students/" + cred.user.uid).set({
        name,
        class: className,
        email,
        createdAt: Date.now()
      });
      statusEl.textContent = "Student created successfully.";
      statusEl.classList.add("success");
      resetForm();
    }
  } catch (e) {
    statusEl.textContent = e.code === "auth/email-already-in-use"
      ? "Email already exists."
      : e.message;
    statusEl.classList.add("error");
  }
};

cancelBtn.onclick = resetForm;

function resetForm() {
  editingId = null;
  nameEl.value = "";
  classEl.value = "";
  emailEl.value = "";
  passwordEl.value = "";
  emailEl.disabled = false;
  passwordEl.style.display = "block";
  submitBtn.textContent = "Create Student";
  formTitle.textContent = "Create Student";
  cancelBtn.style.display = "none";
}

// LOAD STUDENTS
function loadStudents(selectedClass = "") {
  db.ref("students").on("value", snap => {
    tableEl.innerHTML = "";
    const classes = new Set();

    snap.forEach(child => {
      const s = child.val();
      const id = child.key;
      if (s.class) classes.add(s.class);

      if (!selectedClass || selectedClass === s.class) {
        const row = `
          <tr>
            <td>${s.name}</td>
            <td>${s.class}</td>
            <td>${s.email}</td>
            <td class="actions">
              <button class="warning" onclick="editStudent('${id}')">Edit</button>
              <button class="danger" onclick="deleteStudent('${id}')">Delete</button>
            </td>
          </tr>`;
        tableEl.innerHTML += row;
      }
    });

    // Update class filter options
    const current = filterEl.value;
    filterEl.innerHTML = '<option value="">All Classes</option>';
    classes.forEach(c => {
      filterEl.innerHTML += `<option value="${c}">${c}</option>`;
    });
    filterEl.value = current;
  });
}

filterEl.onchange = () => {
  const selected = filterEl.value;
  loadStudents(selected);
};

// EDIT
window.editStudent = id => {
  db.ref("students/" + id).once("value").then(snap => {
    const d = snap.val();
    nameEl.value = d.name;
    classEl.value = d.class;
    emailEl.value = d.email;
    emailEl.disabled = true;
    passwordEl.style.display = "none";
    submitBtn.textContent = "Update Student";
    formTitle.textContent = "Edit Student";
    cancelBtn.style.display = "inline-block";
    editingId = id;
  });
};

// DELETE
window.deleteStudent = id => {
  if (confirm("Are you sure you want to delete this student?")) {
    db.ref("students/" + id).remove();
  }
};

// INITIAL LOAD
loadStudents();
</script>

</body>
</html>
